<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	
	<!-- Resources -->
	<script type="text/javascript" src="js/amcharts.js" ></script>
	<script type="text/javascript" src="js/serial.js" ></script>
	<script type="text/javascript" src="js/light.js" ></script>	
	<script type="text/javascript" src="js/jquery-3.1.1.min.js" ></script>
	
	
<!--<script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
<script src="https://www.amcharts.com/lib/3/serial.js"></script>
<script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
<link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
<script src="https://www.amcharts.com/lib/3/themes/light.js"></script>	-->
	
	<!-- Chart code -->
	<script>
		var chart = AmCharts.makeChart("chartdiv", {
		  "type": "serial",
		  "theme": "light",
		  "dataDateFormat": "YYYY-MM-DD",
		  //Y left
		  "valueAxes": [{
		    "id": "y_total",
		    "title": "Total",
		    "position": "left",
		    "autoGridCount": false,
		    "labelFunction": function(value) {
		      return "$" + Math.round(value);
		    }
		  }, {//Y right
		    "id": "y_count",
		    "title": "Count",
		    "gridAlpha": 0,
		    "position": "right",
		    "autoGridCount": false,
		  }],
		  //bar total
		  "graphs": [{
		    "id": "bar_total",
		    "valueAxis": "y_total",
		    "lineColor": "#62cf73",
		    "fillColors": "#62cf73",
		    "fillAlphas": 1,
		    "type": "column",
		    "title": "Total",
		    "valueField": "total",
		    "clustered": false,
		    "columnWidth": 0.3,
		    "legendValueText": "[[]]",
		    "balloonText": "[[title]]<br /><b style='font-size: 130%'>$[[value]]</b>",
		    "precision": 2
		  }, {//line count
		    "id": "line_count",
		    "valueAxis": "y_count",
		    "bullet": "round",
		    "bulletBorderAlpha": 1,
		    "bulletColor": "#FFFFFF",
		    "bulletSize": 5,
		    "hideBulletsCount": 50,
		    "lineThickness": 2,
		    "lineColor": "#20acd4",
//		    "type": "smoothedLine",
		    "type": "line",
		    "title": "Count",
		    "useLineColorForBulletBorder": true,
		    "valueField": "count",
		    "legendValueText": "[[]]",
		    "balloonText": "[[title]]<br /><b style='font-size: 130%'>[[value]]</b>",
//		    "connect": false
		  }],
		  //x
		  "categoryField": "date",
		  "categoryAxis": {
		    "parseDates": true,
		    "dashLength": 1,
		    "minorGridEnabled": true,
		    "minPeriod":"DD",
			"equalSpacing": true,
			"dateFormats":
				[{period:'fff',format:'JJ:NN:SS'},
				{period:'ss',format:'JJ:NN:SS'},
				{period:'mm',format:'JJ:NN'},
				{period:'hh',format:'JJ:NN'},
				{period:'DD',format:'MMM DD'},
				{period:'WW',format:'MMM DD'},
				{period:'MM',format:'MMM YYYY'},
				{period:'YYYY',format:'YYYY MMM'}],
			},		 
		  
		  //others
		  "chartCursor": {
		    "pan": true,
		    "valueLineEnabled": true,
		    "valueLineBalloonEnabled": true,
		    "cursorAlpha": 0,
		    "valueLineAlpha": 0.2,
		  },
		  "legend": {
		    "useGraphSettings": true,
		    "position": "top"
		  },
		  "balloon": {
		    "borderThickness": 1,
		    "shadowAlpha": 0
		  },
		  //data
//		  "dataProvider":
//			[{
//				"date": "2013-01-16",
//				"count": 71,
//				"total": 6582
//			}, {
//				"date": "2013-01-17",
//				"count": 74,
//				"total": 6820.5
//			}]			  

		});
		
		function updateChart(data,minPeriod){
			chart.dataProvider = data;
			chart.categoryAxis.minPeriod = minPeriod;
			chart.validateNow();
			chart.validateData();
			
			console.log(chart);
		} 		
		
		$(function(){
			
			$.ajax('json/date_range.json', {
		      type : 'GET',
		      dataType : "json"
		    }).done(function(data) {
				updateChart(data,'DD');
		    }).fail(function(data) {
		    });			
			
			$('#btn-range').click(function(){
				$.ajax('json/date_range.json', {
			      type : 'GET',
			      dataType : "json"
			    }).done(function(data) {
					updateChart(data,'DD');
			    }).fail(function(data) {
			    });
			});
			
			$('#btn-week').click(function(){
				$.ajax('json/date_week.json', {
			      type : 'GET',
			      dataType : "json"
			    }).done(function(data) {
					updateChart(data,'WW');
			    }).fail(function(data) {
			    });
			})	
			
			$('#btn-month').click(function(){
				$.ajax('json/date_month.json', {
			      type : 'GET',
			      dataType : "json"
			    }).done(function(data) {
					updateChart(data,'MM');
			    }).fail(function(data) {
			    });
			})	
			
			$('#btn-year').click(function(){
				$.ajax('json/date_year.json', {
			      type : 'GET',
			      dataType : "json"
			    }).done(function(data) {
					updateChart(data,'YYYY');
			    }).fail(function(data) {
			    });
			})			
			
		})
		
	</script>	
	<body>
		<!-- HTML -->
		<div id="chartdiv" style="width: 100%;height: 500px;"></div>	
		
		<button id="btn-range">Date Range</button> |
		<button id="btn-week">Week</button> |
		<button id="btn-month">Month</button> |
		<button id="btn-year">Year</button>
	</body>
</html>

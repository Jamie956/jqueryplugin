<!-- data source -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>

<style>
  .myselect {
    width: 50%;
  }
</style>

<select class="myselect" />

<script>
  $(function () {
    $(".myselect").select2({
      ajax: {
        url: "https://api.github.com/search/repositories",
        dataType: 'json',
        delay: 250,
        //定义参数  q:参数名， params.term:输入框的内容
        data: function (params) {
          console.log('call data: ', params);
          return {
            q: params.term,
          };
        },
        //预处理返回结果  data:返回数据
        processResults: function (data) {
          console.log('call processResults: ', data)
          return {
            results: data.items
          };
        },
        cache: true
      },
      escapeMarkup: function (markup) { return markup; },//字符转义处理
      minimumInputLength: 1,//最小需要输入多少个字符才进行查询
      //显示返回结果选项的模板，有数据时repo相当于processResults的return
      templateResult: function (repo) {
        console.log('call templateResult')
        if (repo.full_name) {
          return `* ${repo.full_name}`
        }
        return repo.text;
      },
      //显示选中的模板
      templateSelection: function (repo) {
        console.log('call templateSelection: ', repo)
        if (repo.full_name) {
          return `Your selected: ${repo.full_name}`
        }
        return repo.text;
      }
    });
  })
</script>